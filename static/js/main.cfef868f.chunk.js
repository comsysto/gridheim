(this.webpackJsonpgridheim=this.webpackJsonpgridheim||[]).push([[0],{105:function(e,t,n){e.exports=n.p+"static/media/john-westrock-UHFQPFt5-WA-unsplash.3466438c.jpg"},106:function(e,t,n){e.exports=n(145)},114:function(e,t){},137:function(e,t,n){},145:function(e,t,n){"use strict";n.r(t);var a=n(98),r=n.n(a),c=n(0),i=n.n(c),o=n(99),l=n.n(o),s=(n(137),n(2)),u=n(10),m=n(23),d=n(9),h=function(e){var t=e.className,n=e.children;return i.a.createElement("div",{className:"list-group ".concat(t||"")},n)},f=n(4),b=n(3),p=n(52);function g(){return function(e){e[p.b]=!0}}var v,E,y,w=function(){function e(t,n){Object(f.a)(this,e),this.x=t,this.y=n,Object.freeze(this)}return Object(b.a)(e,null,[{key:"fromCoords",value:function(t){return new e(t.x,t.y)}},{key:"fromClientCoords",value:function(t){return new e(t.clientX,t.clientY)}},{key:"fromDeltaCoords",value:function(t){return new e(t.deltaX,t.deltaY)}},{key:"fromNumber",value:function(t){return new e(t,t)}}]),Object(b.a)(e,[{key:"subtract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"scale",value:function(t){return new e(this.x*t,this.y*t)}},{key:"withX",value:function(t){return new e(t,this.y)}},{key:"withY",value:function(t){return new e(this.x,t)}},{key:"addX",value:function(e){return this.withX(this.x+e)}},{key:"addY",value:function(e){return this.withY(this.y+e)}},{key:"equals",value:function(e){return!!(e&&e.x&&e.y)&&(this.x===e.x&&this.y===e.y)}},{key:"abs",get:function(){return new e(Math.abs(this.x),Math.abs(this.y))}},{key:"length",get:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"maxComponent",get:function(){return Math.max(this.x,this.y)}},{key:"inverseX",get:function(){return this.withX(-this.x)}},{key:"inverseY",get:function(){return this.withY(-this.y)}},{key:"ceil",get:function(){return new e(Math.ceil(this.x),Math.ceil(this.y))}}]),e}();w.zero=w.fromNumber(0);var S=g()((y=E=function(){function e(t,n,a){Object(f.a)(this,e),this.name=t,this.image=n,this.transform=a,Object.freeze(this)}return Object(b.a)(e,null,[{key:"storageKey",value:function(e){return"".concat(this.STORAGE_KEY_PREFIX).concat(e)}},{key:"isStorageKey",value:function(e){return e.startsWith(this.STORAGE_KEY_PREFIX)}}]),Object(b.a)(e,[{key:"squares",get:function(){return new w(this.image.width,this.image.height).scale(this.transform.scale).ceil}},{key:"isAsset",get:function(){return!1}}]),e}(),E.STORAGE_KEY_PREFIX="map-",v=y))||v,O=function(e){var t=e.children;return i.a.createElement("div",{className:"media"},t)},k=function(e){var t=e.children;return i.a.createElement("div",{className:"media-body"},t)},j=function(e){var t=e.children;return i.a.createElement("div",{className:"list-group-item"},t)},N=function(e){var t=e.gridMaps,n=e.children;return i.a.createElement(h,null,Object.values(t).map((function(e){return i.a.createElement(j,{key:e.name},i.a.createElement(O,null,i.a.createElement(k,null,i.a.createElement("h4",null,e.name),i.a.createElement("dl",{className:"row"},i.a.createElement("dt",{className:"col-sm-3"},"Size in Squares"),i.a.createElement("dd",{className:"col-sm-9"},e.squares.x,"x",e.squares.y),e instanceof S&&i.a.createElement(i.a.Fragment,null,i.a.createElement("dt",{className:"col-sm-3"},"Scale"),i.a.createElement("dd",{className:"col-sm-9"},e.transform.scale),i.a.createElement("dt",{className:"col-sm-3"},"X Offset"),i.a.createElement("dd",{className:"col-sm-9"},e.transform.translate.x),i.a.createElement("dt",{className:"col-sm-3"},"Y Offset"),i.a.createElement("dd",{className:"col-sm-9"},e.transform.translate.y))),i.a.createElement("div",null,n&&n(e))),e instanceof S&&i.a.createElement("img",{className:"ml-3 img-thumbnail image-300",src:e.image.url})))})))},x=i.a.createContext((function(){})),T=function(e){var t=e.heading,n=e.children,a=Object(c.useRef)(null);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{ref:a,className:"h-100 scrollable-y full-page-with-heading_content-container"},i.a.createElement("div",{className:"container text-center full-page-with-heading_heading-container"},t),i.a.createElement(x.Provider,{value:function(){a.current&&a.current.scrollTo(0,0)}},i.a.createElement("div",{className:"container"},n))))},M=n(1),C=function(e){var t=e.children;return i.a.createElement("div",{className:"alert alert-primary"},t)},$=function(e){e.icon;var t=e.headline,n=e.children;return i.a.createElement(i.a.Fragment,null,i.a.createElement("h1",null,i.a.createElement("span",{className:"ml-4"},t)),n)},L=function(e){var t=e.icon,n=e.headline,a=e.children;return i.a.createElement($,{icon:t,headline:n},i.a.createElement("div",{className:"ml-5 mt-3 mb-3 text-left"},i.a.Children.map(a,(function(e,t){return i.a.createElement(i.a.Fragment,null,0!==t&&i.a.createElement("span",{className:"ml-2"}),e)}))))},P=function(e){var t=e.imageGridMapRepository,n=Object(c.useState)(null),a=Object(s.a)(n,2),r=a[0],o=a[1],l=Object(c.useState)([]),u=Object(s.a)(l,2),m=u[0],d=u[1],h=Object(c.useCallback)((function(){t.findAll().subscribe({next:d})}),[t]);Object(c.useEffect)((function(){h()}),[h]);var f=i.a.createElement(L,{icon:M.k,headline:"Manage Maps"},r&&i.a.createElement(i.a.Fragment,null));return i.a.createElement(i.a.Fragment,null,i.a.createElement(T,{heading:f},i.a.createElement(C,null,i.a.createElement("strong",null,"Maps")," are stored images with a grid drawn over them.",i.a.createElement("br",null),"You create a map by selecting an image file on your computer and configure a grid for them. The images are stored locally in your browser local storage and are not sent to the internet."),i.a.createElement("div",null,i.a.createElement("div",{className:"col-md-12"},i.a.createElement(N,{gridMaps:m},(function(e){return i.a.createElement("button",{type:"button",className:"btn btn-danger ml-2",onClick:function(){t.delete(e.name),o(null),h()}},i.a.createElement(M.G,{icon:M.D}),"\xa0 Delete Map")}))))))},D=function(e){var t=e.sessions,n=e.gridMapsForName,a=e.children;return i.a.createElement(h,null,t.map((function(e){var t=n[e.gridMapName];return i.a.createElement(j,{key:e.name},i.a.createElement(O,null,i.a.createElement(k,null,i.a.createElement("h4",null,e.name),i.a.createElement("dl",{className:"row"},t&&i.a.createElement(i.a.Fragment,null,i.a.createElement("dt",{className:"col-sm-3"},"Map"),i.a.createElement("dd",{className:"col-sm-9"},t.name," (",t.squares.x,"x",t.squares.y,")")),i.a.createElement("dt",{className:"col-sm-3"},"Date"),i.a.createElement("dd",{className:"col-sm-9"},e.date)),!t&&i.a.createElement("span",{className:"badge badge-pill badge-danger"},"Invalid: Background is missing"),i.a.createElement("div",null,a&&a(e))),t&&t instanceof S&&i.a.createElement("img",{src:t.image.url,className:"img-thumbnail image-200"})))})))},A=n(147);function z(e,t){return e.reduce((function(e,n){return e[t(n)]=n,e}),{})}var R,q,F=function(){return Object(c.useContext)(d.e)},B=function(){for(var e=F(),t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.map((function(t){return function(){e.history.push(t)}}))},I=function(e){var t=e.gridMapService,n=e.sessionRepository,a=Object(c.useState)([]),r=Object(s.a)(a,2),o=r[0],l=r[1],u=Object(c.useState)({}),m=Object(s.a)(u,2),d=m[0],h=m[1],f=Object(c.useCallback)((function(){Object(A.a)([n.findAll(),t.getGridMaps()]).subscribe({next:function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];l(n),h(z(a,(function(e){return e.name})))}})}),[n,t]);Object(c.useEffect)((function(){f()}),[f]);var b=B(Tn.play),p=Object(s.a)(b,1)[0],g=i.a.createElement($,{icon:M.z,headline:"Sessions"});return i.a.createElement(T,{heading:g},i.a.createElement(C,null,i.a.createElement("strong",null,"Sessions")," are the place where all token positions on the map and all drawings are stored.",i.a.createElement("br",null),"You can switch between sessions on this screen so you can come back to a game later ..."),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(D,{sessions:o,gridMapsForName:d},(function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{type:"button",className:"btn btn-primary mr-2",onClick:function(){n.storeCurrentSessionName(e.name),p()}},i.a.createElement(M.G,{icon:M.w}),"\xa0 Start Session"),i.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){n.delete(e.name),f()}},i.a.createElement(M.G,{icon:M.D}),"\xa0 Delete Session"))})))))},G=function(e){return Object(u.a)(e),i.a.createElement(i.a.Fragment,null,i.a.createElement("h1",null,"Manage Token Types"))},_=function(e){return Object(u.a)(e),i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body"},i.a.createElement("p",null,i.a.createElement("strong",null,"Gridheim")," is a digital grid map. Grid maps are used for pen&pencil roll playing games (like D&D, pathfinder, etc.) to show the position of characters and monsters on a map of the environment."),i.a.createElement("h5",{className:"mt-5"},i.a.createElement(M.G,{icon:M.r,size:25}),i.a.createElement("span",{className:"ml-3"},"The goals of ",i.a.createElement("strong",null,"Gridheim")," are ..."," ")),i.a.createElement("ul",null,i.a.createElement("li",null,"A good user experience"),i.a.createElement("li",null,"Cross platform and cross device compatibility"),i.a.createElement("li",null,"Pen support"),i.a.createElement("li",null,"Offline support via service worker"),i.a.createElement("li",null,"Data privacy - All data is only stored locally in your browser"))))},K=function(e){return Object(u.a)(e),i.a.createElement("div",{className:"card mt-5"},i.a.createElement("div",{className:"card-body"},i.a.createElement(O,null,i.a.createElement(k,null,i.a.createElement("h5",null,i.a.createElement(M.G,{icon:M.l,size:25}),i.a.createElement("span",{className:"ml-3"},"Hello my name is ",i.a.createElement("strong",null,"Otto")," ...")),i.a.createElement("p",null,"... and I'm a Software Engineer at",i.a.createElement("a",{href:"https://comsystoreply.de/"}," Comsysto Reply "),"nice to meet you!",i.a.createElement("br",null),i.a.createElement("small",null,i.a.createElement("a",{href:"https://comsystoreply.de/karriere"},"(PS: we're hiring)"))),i.a.createElement("p",null,"Let me explain to you why I created yet another map tool :D ...",i.a.createElement("br",null),"It all begun when I searched for a way to visualise battles in my D&D campaign.",i.a.createElement("br",null),"The first approach was to use a physical map, which was nearly impossible for the huge maps that are often used in campaign books. The printout would be more than 2 meters in length.",i.a.createElement("br",null),"The next thing we tried was to use a tablet with a pen. This works quite smoothly because it has a similar usability than the pencil drawn maps of my youth, but it was quite challenging to move the tokens around. Every token has to be erased and drawn again in a other location. So we tried finding a dedicated software that would run on tablets, sadly we don't found one that has worked with the pen which was a blast to use :D ..."),i.a.createElement("p",null,"In the mean time I was building some dashboard prototypes at work that uses SVG graphics together with React which has quite similar characteristics ...",i.a.createElement("br",null),"... so I decided to give it a try, how hard can it be XD")),i.a.createElement("img",{className:"img-thumbnail mr-3",src:"https://www.gravatar.com/avatar/6f1aded52d041be71a1f5168c6b7e7dd?s=250"}))))},Y=Object.freeze({playPage:{controlBar:{drawBackgroundButton:"Draw something that should be shown on the gridMap like spell effects, environment hazards etc.",drawNotesButton:"Open the notes pane where you can write some notes with a pen.",playButton:"Enter play mode, so you can move tokens.",addTokensButton:"Add a new token to the game board.",zoomButton:"Zoom in or out and change orientation of the map."}},newSessionPage:{headline:"Start New Session",explanation:i.a.createElement(i.a.Fragment,null,i.a.createElement("strong",null,"Sessions")," are the place where all token positions on the map and all drawings are stored.",i.a.createElement("br",null),"You can switch between sessions on this screen so you can come back to a game later ...")},assetPage:{headline:"Used 3rd Party Assets"},openSourcePage:{headline:"Used Open Source Components"},aboutPage:{headline:"Let me tell you about Gridheim, Friend ...",startLink:"Enough talk just start ..."},startPage:{headline:"Welcome to Gridheim, Friend!",sections:{play:{headline:"Play",icon:M.w},gridMaps:{headline:"Maps",icon:M.k},info:{headline:"Info",icon:M.o}},about:{description:"TBD",button:"About"},openSource:{description:"TBD",button:"Open Source"},assets:{description:"TBD",button:"3rd Party Assets"},newGridMap:{description:"TBD",button:"Add Map"},newSession:{description:"TBD",button:"Start New Session"},play:{description:"TBD",button:"Continue Session"},showGridMaps:{description:"TBD",button:"Manage Maps"},showSessions:{description:"TBD",button:"Manage Sessions"}}}),U=function(e){return Object(u.a)(e),i.a.createElement(T,{heading:i.a.createElement($,{icon:M.o,headline:Y.aboutPage.headline},i.a.createElement(m.b,{to:Tn.start},i.a.createElement(M.G,{icon:M.w})," ",Y.aboutPage.startLink))},i.a.createElement(_,null),i.a.createElement(K,null))},W=g()(R=function e(t,n,a,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.size;Object(f.a)(this,e),this.id=t,this.tokenType=n,this.label=a,this.square=r,this.size=c})||R,V=g()(q=function(){function e(t,n){Object(f.a)(this,e),this.x=t,this.y=n}return Object(b.a)(e,[{key:"toCoordinateString",value:function(){return"".concat(this.x,"/").concat(this.y)}}]),e}())||q,X=n(20),H=function(){function e(t,n,a,r){Object(f.a)(this,e),this.id=t,this.path=n,this.color=a,this.width=r,this.current=this.id===e.CURRENT_ID}return Object(b.a)(e,null,[{key:"current",value:function(t,n){return new e(e.CURRENT_ID,[],t,n)}}]),Object(b.a)(e,[{key:"withPointAdded",value:function(t,n){return new e(this.id,[].concat(Object(X.a)(this.path),[[t,n]]),this.color,this.width)}},{key:"withId",value:function(t){return new e(t,this.path,this.color,this.width)}},{key:"svgPath",get:function(){return this.path.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")}}]),e}();H.CURRENT_ID="current";var J=function(){function e(t){Object(f.a)(this,e),this.drawings=t}return Object(b.a)(e,null,[{key:"fromJson",value:function(t){return new e(t.drawings.map((function(e){return new H(e.id,e.path,e.color,e.width)})))}}]),Object(b.a)(e,[{key:"withDrawingAdded",value:function(t){return new e([].concat(Object(X.a)(this.drawings),[t]))}},{key:"withCurrentDrawingRemoved",value:function(){return this.withDrawingRemoved(H.CURRENT_ID)}},{key:"withDrawingRemoved",value:function(t){return new e(this.drawings.filter((function(e){return e.id!==t})))}}]),e}(),Z=n(60),Q=n(12),ee=n(11),te=n(13),ne=n(149);function ae(){var e=(new Date).getTime();return"undefined"!==typeof performance&&"function"===typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}var re=n(150),ce=n(58),ie=n(148),oe=function(){function e(){Object(f.a)(this,e),this.disposeS$=new ce.a,this.dispose$=this.disposeS$.asObservable()}return Object(b.a)(e,[{key:"dispose",value:function(){this.disposeS$.next(),this.disposeS$.complete()}},{key:"untilDisposed",value:function(e){return e.pipe(Object(ie.a)(this.dispose$))}}]),e}(),le=function(e){return Object(X.a)(Array(e).keys())},se=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(Q.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).tokensS$=new ne.a([]),n.tokens$=n.tokensS$.asObservable(),n.selectedTokenS$=new ne.a(null),n.selectedToken$=n.selectedTokenS$.asObservable(),n.selectedSquareS$=new ne.a(null),n.selectedSquare$=n.selectedSquareS$.asObservable(),n.squareSelectableS$=new ne.a(!1),n.squareSelectable$=n.squareSelectableS$.asObservable(),n.tokenSelectableS$=new ne.a(!1),n.tokenSelectable$=n.tokenSelectableS$.asObservable(),n.tokenSizeS$=new ne.a(1),n.tokenSize$=n.tokenSizeS$.asObservable(),n.hoveringSquareS$=new ne.a(null),n.hoveringSquare$=n.hoveringSquareS$.asObservable(),n.highlightedSquares$=Object(A.a)([n.squareSelectable$,n.tokenSize$,n.selectedToken$,n.hoveringSquare$]).pipe(Object(Z.a)((function(e){var n=Object(s.a)(e,4),a=n[0],r=n[1],c=n[2],i=n[3];if(!i||!a)return t.EMPTY_READONLY_ARRAY;var o=c?c.size:r,l=le(o).map((function(e){return le(o).map((function(t){return new V(i.x+e,i.y+t)}))}));return Object.freeze(l.flat())})),Object(re.a)(50)),n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"selectToken",value:function(e){this.tokenSelectable&&this.selectedTokenS$.next(e)}},{key:"selectSquare",value:function(e){this.selectedSquareS$.next(e)}},{key:"updateTokens",value:function(e){var t=Object(p.a)(this.tokensS$.value,e);this.tokensS$.next(t);var n=this.selectedTokenS$.value;if(n){var a=this.tokensS$.value.find((function(e){return n.id===e.id}));this.selectedTokenS$.next(a||null)}}},{key:"addToken",value:function(e,t,n,a){this.updateTokens((function(r){r.push(new W(ae(),e,t,a,n))}));var r=this.tokensS$.value;this.selectToken(r[r.length-1])}},{key:"setSquareSelectable",value:function(e){this.squareSelectableS$.next(e)}},{key:"setTokenSelectable",value:function(e){this.tokenSelectableS$.next(e)}},{key:"removeSelectedToken",value:function(){if(null!==this.selectedToken){var e=this.selectedToken.id;this.updateTokens((function(t){return t.filter((function(t){return t.id!==e}))}))}}},{key:"hoverOverSquare",value:function(e){this.hoveringSquareS$.next(e)}},{key:"setTokenSize",value:function(e){this.tokenSizeS$.next(e)}},{key:"selectedToken",get:function(){return this.selectedTokenS$.value}},{key:"squareSelectable",get:function(){return this.squareSelectableS$.value}},{key:"tokenSelectable",get:function(){return this.tokenSelectableS$.value}}]),t}(oe);se.EMPTY_READONLY_ARRAY=Object.freeze([]);var ue,me,de=n(151),he=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(Q.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).activeS$=new ne.a(!1),n.active$=n.activeS$.asObservable(),n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"activate",value:function(e){var t=this;this.onActivate(e),e.subscribe({next:function(){return t.activeS$.next(!1)}}),this.activeS$.next(!0)}},{key:"active",get:function(){return this.activeS$.value}}]),t}(oe),fe=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(Q.a)(this,Object(ee.a)(t).call(this))).battleMapService=e,n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"onActivate",value:function(e){var t=this;this.battleMapService.setTokenSelectable(!0),this.battleMapService.setSquareSelectable(!0),this.battleMapService.selectSquare(null),this.battleMapService.selectToken(null),Object(A.a)([this.battleMapService.selectedToken$,this.battleMapService.selectedSquare$]).pipe(Object(ie.a)(e),Object(de.a)((function(e,t){return e===t}),(function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return"".concat(n,"/").concat(a)}))).subscribe((function(e){var n=Object(s.a)(e,2),a=n[0],r=n[1];a&&!r&&t.battleMapService.setSquareSelectable(!0),a||r||t.battleMapService.setSquareSelectable(!1),a&&r&&(t.battleMapService.selectSquare(null),t.battleMapService.updateTokens((function(e){e.filter((function(e){return e.id===a.id})).forEach((function(e){return e.square=r}))})))}))}}]),t}(he);!function(e){e.red="red",e.yellow="yellow",e.blue="blue",e.green="green",e.purple="purple",e.orange="orange"}(ue||(ue={})),function(e){e.s="s",e.m="m",e.l="l"}(me||(me={}));var be,pe=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(Q.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).paneS$=new ne.a(new J([])),n.pane$=n.paneS$.asObservable(),n.drawingColorS$=new ne.a(ue.red),n.drawingColor$=n.drawingColorS$.asObservable(),n.drawingWidthS$=new ne.a(me.m),n.drawingWidth$=n.drawingWidthS$.asObservable(),n.drawingModeS$=new ne.a("draw"),n.drawingMode$=n.drawingModeS$.asObservable(),n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"currentlyDrawing",value:function(e){var t=this;if(this.active){var n=this.paneS$.value,a=H.current(this.drawingColor,this.drawingWidth);e.subscribe({next:function(e){var r;a=(r=a).withPointAdded.apply(r,Object(X.a)(e));var c=n.withDrawingAdded(a);t.paneS$.next(c)},error:function(){t.paneS$.next(n)},complete:function(){t.paneS$.next(n.withDrawingAdded(a.withId(ae())))}})}}},{key:"removeDrawing",value:function(e){var t=this.paneS$.value;this.paneS$.next(t.withDrawingRemoved(e))}},{key:"switchDrawingColor",value:function(e){this.drawingColorS$.next(e)}},{key:"switchDrawingWidth",value:function(e){this.drawingWidthS$.next(e)}},{key:"switchDrawingMode",value:function(e){this.drawingModeS$.next(e)}},{key:"setPane",value:function(e){this.paneS$.next(e)}},{key:"onActivate",value:function(){}},{key:"drawingColor",get:function(){return this.drawingColorS$.value}},{key:"drawingMode",get:function(){return this.drawingModeS$.value}},{key:"drawingWidth",get:function(){return this.drawingWidthS$.value}}]),t}(he),ge=g()(be=function e(t,n,a,r){Object(f.a)(this,e),this.size=t,this.color=n,this.border=a,this.name=r})||be,ve=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(Q.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).defaultStrokeColor="#555555",n.tokenTypes=[new ge(1,"#ff28fb","#ffaaf3","Mora"),new ge(1,"#ff8902","#ffd069","Elsa"),new ge(1,"#78cc85",n.defaultStrokeColor,"LightGreen"),new ge(1,"#077919",n.defaultStrokeColor,"Green"),new ge(1,"#98c6ff",n.defaultStrokeColor,"LightBlue"),new ge(1,"#0282ff",n.defaultStrokeColor,"Blue"),new ge(1,"#9f6a00",n.defaultStrokeColor,"LightBrown"),new ge(1,"#513200",n.defaultStrokeColor,"Brown"),new ge(1,"#ff5354",n.defaultStrokeColor,"LightRed"),new ge(1,"#c70200",n.defaultStrokeColor,"Red"),new ge(1,"#ffff8e",n.defaultStrokeColor,"LightYellow"),new ge(1,"#ffef00",n.defaultStrokeColor,"Yellow"),new ge(1,"#d67eff",n.defaultStrokeColor,"LightPurple"),new ge(1,"#9f00d3",n.defaultStrokeColor,"Purple"),new ge(1,"#f4e4ee",n.defaultStrokeColor,"LightGrey"),new ge(1,"#645e5d",n.defaultStrokeColor,"DarkGrey")],n.tokenLabels=[" ","1","2","3","4","5","6","7","8","9","Boss","L1","L2","L3","M1","M2","M3","P1","P2","P3"],n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"tokenTypeForName",value:function(e){return this.tokenTypes.find((function(t){return t.name===e}))||null}}]),t}(oe),Ee=n(152);function ye(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.some((function(t){return t===e}))}}var we=function(){function e(){Object(f.a)(this,e)}return Object(b.a)(e,null,[{key:"controlServices",value:function(e,t){var n=null,a=function(){n&&(n.next(),n.complete(),n=null)};e.subscribe({next:function(e){if(a(),e){var r=t[e];r&&(n=new ce.a,r.activate(n))}},complete:function(){console.log("mode based complete"),a()},error:function(){a()}})}}]),e}(),Se=function(e){function t(e,n){var a;return Object(f.a)(this,t),(a=Object(Q.a)(this,Object(ee.a)(t).call(this))).battleMapService=e,a.assetService=n,a.mode$S=new ne.a("add-token"),a.mode$=a.mode$S.asObservable().pipe(Object(Ee.a)((function(e){return console.log("manageTokenMode",e)}))),a.modeCallbacks={"switch-token-type":{activate:function(){a.battleMapService.setTokenSelectable(!1),a.battleMapService.setSquareSelectable(!1),a.battleMapService.selectSquare(null),a.battleMapService.selectToken(null)}},"add-token":{activate:function(e){a.battleMapService.setTokenSelectable(!1),a.battleMapService.setSquareSelectable(!0),a.battleMapService.selectSquare(null),a.battleMapService.selectToken(null),a.battleMapService.setTokenSize(a.tokenSizeS$.value),Object(A.a)([a.tokenType$,a.tokenLabel$,a.tokenSize$,a.battleMapService.selectedSquare$]).pipe(Object(ie.a)(e)).subscribe((function(e){var t=Object(s.a)(e,4),n=t[0],r=t[1],c=t[2],i=t[3];i&&n&&r&&c&&(a.battleMapService.selectSquare(null),a.battleMapService.addToken(n,r,c,i))})),e.subscribe({next:function(){a.battleMapService.setTokenSize(1)}})}},"remove-token":{activate:function(e){a.battleMapService.setTokenSelectable(!0),a.battleMapService.setSquareSelectable(!1),a.battleMapService.selectSquare(null),a.battleMapService.selectToken(null),Object(A.a)([a.tokenType$,a.tokenLabel$,a.battleMapService.selectedToken$]).pipe(Object(ie.a)(e)).subscribe((function(e){var t=Object(s.a)(e,3),n=t[0],r=t[1];t[2]&&n&&r&&a.battleMapService.removeSelectedToken()}))}},inactive:null},a.isSwitchTokenType$=a.mode$.pipe(Object(Z.a)(ye("switch-token-type"))),a.tokenTypeS$=new ne.a(a.assetService.tokenTypes[0]),a.tokenType$=a.tokenTypeS$.asObservable(),a.tokenLabelS$=new ne.a(a.assetService.tokenLabels[0]),a.tokenLabel$=a.tokenLabelS$.asObservable(),a.tokenSizeS$=new ne.a(1),a.tokenSize$=a.tokenSizeS$.asObservable(),a}return Object(te.a)(t,e),Object(b.a)(t,[{key:"onActivate",value:function(e){var t=this;we.controlServices(this.mode$.pipe(Object(ie.a)(e)),this.modeCallbacks),e.subscribe({next:function(){t.mode$S.next("inactive")}}),this.mode$S.next("add-token")}},{key:"setTokenType",value:function(e){this.tokenTypeS$.next(e)}},{key:"setTokenLabel",value:function(e){this.tokenLabelS$.next(e)}},{key:"setTokenSize",value:function(e){this.tokenSizeS$.next(e)}},{key:"switchMode",value:function(e){this.mode$S.next(e)}},{key:"tokenType",get:function(){return this.tokenTypeS$.value}},{key:"tokenLabel",get:function(){return this.tokenLabelS$.value}},{key:"tokenSize",get:function(){return this.tokenSizeS$.value}}]),t}(he),Oe=function(e){function t(e,n){var a;return Object(f.a)(this,t),(a=Object(Q.a)(this,Object(ee.a)(t).call(this))).initalMode=e,a.modeS$=new ne.a(a.initalMode),a.mode$=a.modeS$.asObservable(),we.controlServices(a.untilDisposed(a.mode$),n),a}return Object(te.a)(t,e),Object(b.a)(t,[{key:"switchMode",value:function(e){this.modeS$.next(e)}},{key:"oneOf",value:function(){return this.mode$.pipe(Object(Z.a)(ye.apply(void 0,arguments)))}},{key:"mode",get:function(){return this.modeS$.value}}]),t}(oe),ke=n(6),je=n(102),Ne=n(103),xe=n(158),Te=n(153),Me=n(154);function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(n,!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Le=function(e){function t(e,n){var a;return Object(f.a)(this,t),(a=Object(Q.a)(this,Object(ee.a)(t).call(this))).gridMapService=e,a.sessionRepository=n,a.onLoad={},a.toStore={},a.sessionS$=new ne.a(null),a.session$=a.untilDisposed(a.sessionS$.asObservable()),a.gridMapS$=new ne.a(null),a.gridMap$=a.untilDisposed(a.gridMapS$.asObservable()),a.session$.pipe(Object(xe.a)(1e4)).subscribe({next:function(){console.log("saving session",a.session),a.saveSession()}}),a}return Object(te.a)(t,e),Object(b.a)(t,[{key:"saveSession",value:function(){this.session&&this.sessionRepository.store(this.session)}},{key:"add",value:function(e,t){var n=new ce.a;return this.onLoad=$e({},this.onLoad,Object(ke.a)({},e,n)),this.toStore=$e({},this.toStore,Object(ke.a)({},e,t)),n.asObservable()}},{key:"loadAndStart",value:function(){var e=this;return this.sessionRepository.findCurrentSessionName().pipe(Object(Te.a)((function(e){return e?Object(je.a)(e):Object(Ne.a)("No current session name found in local storage")})),Object(Te.a)((function(t){return e.sessionRepository.findBy(t)})),Object(Te.a)((function(e){return e?Object(je.a)(e):Object(Ne.a)("Failed Loading Session")})),Object(Te.a)((function(t){return e.gridMapService.getGridMapByName(t.gridMapName).pipe(Object(Z.a)((function(e){return[t,e]})))})),Object(Te.a)((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return a?Object(je.a)([n,a]):Object(Ne.a)("Session with no gridMapName")})),Object(Z.a)((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return Object.keys(e.onLoad).forEach((function(t){var n=a.content[t];if(n){var r=e.onLoad[t];r.next(n),r.complete()}})),Object.keys(e.toStore).forEach((function(t){var n=e.toStore[t];e.untilDisposed(n).subscribe((function(n){e.session&&e.sessionS$.next(e.session.with({date:(new Date).toLocaleString(),content:$e({},e.session.content,Object(ke.a)({},t,n))}))}))})),e.sessionS$.next(a),e.gridMapS$.next(r),!0})),Object(Me.a)((function(e){return console.log("Failed loading session: ".concat(e)),Object(je.a)(!1)})))}},{key:"session",get:function(){return this.sessionS$.value}}]),t}(oe),Pe=function(e){var t=e.gridMap;return i.a.createElement("g",t.transform.scaleTranslateAttribute,i.a.createElement("image",{width:t.image.width,height:t.image.height,xlinkHref:t.image.url}))};function De(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[e],a=Object(c.useState)(t),r=Object(s.a)(a,2),i=r[0],o=r[1];return Object(c.useEffect)((function(){var t;if(e&&(t="function"===typeof e?e():e)){var n=t.subscribe((function(e){o(e)}));return function(){return n.unsubscribe()}}}),n),i}var Ae=function(e){return Object.keys(e).filter((function(t){return e[t]})).join(" ")},ze=function(e){var t=e.tokenClasses,n=e.tokenType,a=e.tokenSize,r=e.tokenLabel,c=e.square,o=e.onClick;return c=c||new V(0,0),i.a.createElement("g",{onClick:function(e){o&&(e.preventDefault(),e.stopPropagation(),console.log("here"),o())}},i.a.createElement("circle",{className:"token ".concat(t?Ae(t):""),fill:n.color,stroke:n.border,r:a/2,cx:c.x+a/2,cy:c.y+a/2}),r&&i.a.createElement("text",{className:"token-text",x:c.x+a/2,y:c.y+.2+a/2},r))},Re=function(e){var t=e.tokens,n=e.onClick,a=De(e.selectedToken$,null);return i.a.createElement("g",null,t.map((function(e){return i.a.createElement("g",{key:e.id},i.a.createElement(ze,{tokenType:e.tokenType,tokenLabel:e.label,tokenSize:e.size,square:e.square,onClick:function(){return n(e)}}))})),a&&i.a.createElement(ze,{tokenType:a.tokenType,tokenLabel:a.label,tokenSize:a.size,square:a.square,onClick:function(){return n(null)},tokenClasses:{"selected-token":!0}}))},qe=function(e,t){var n=t.ownerSVGElement.createSVGPoint();return n.x=e.x,n.y=e.y,n.matrixTransform(t.getScreenCTM().inverse())};function Fe(e,t){var n=qe(e,t);return w.fromCoords(n)}function Be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.currentTarget;return Fe(w.fromClientCoords(e),t)}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ge=function(e){var t=e.drawingService,n=Object(c.useState)(null),a=Object(s.a)(n,2),r=a[0],o=a[1],l=De(t.active$,!1),u=De(t.drawingMode$,"draw");return i.a.createElement(i.a.Fragment,null,"draw"===u&&l&&i.a.createElement("rect",{x:-500,y:-500,width:1e3,height:1e3,className:"drawing-capture-pane",onPointerDown:function(e){if(t.active){var n=new ce.a;o(n),t.currentlyDrawing(n)}},onPointerUp:function(e){r&&(r.complete(),o(null))},onPointerCancel:function(e){return console.log("canceled",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(n,!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},onPointerMove:function(e){if(r){var t=Be(e);r.next([t.x,t.y])}}}))},_e="drawing-".length,Ke=function(e){var t=e.drawingService,n=e.name,a=De(t.pane$,null),r=De(t.drawingMode$,"draw"),o=Object(c.useRef)(null),l=Object(c.useState)(null),u=Object(s.a)(l,2),m=u[0];u[1];return a&&i.a.createElement(i.a.Fragment,null,i.a.createElement("g",{id:n,className:"drawing-pane ".concat(n," ").concat(r," "),onPointerMove:function(e){if("erase"===t.drawingMode&&1===e.buttons&&o.current){var n=o.current,a=qe(w.fromClientCoords(e),n);n.childNodes.forEach((function(e){if(e instanceof SVGPolylineElement&&(e.isPointInStroke(a)||e.isPointInFill(a))){var n=e.id.substring(_e);t.removeDrawing(n)}}))}}},i.a.createElement("rect",{x:-500,y:-500,width:1e3,height:1e3,className:"drawing-pane-background ".concat(n)}),i.a.createElement("g",{ref:o},a.drawings.map((function(e){var t;return i.a.createElement("polyline",{id:"".concat("drawing-").concat(e.id),key:e.id,className:Ae((t={drawing:!0,current:"current"===e.id},Object(ke.a)(t,"drawing-".concat(e.color),!0),Object(ke.a)(t,"drawing-".concat(e.width),!0),t)),points:e.svgPath})}))),m&&i.a.createElement("rect",{x:m.x,y:m.y,width:m.width,height:m.height,fill:"blue"})))},Ye=function(e){var t=Object(c.useRef)(!1),n=Object(c.useState)(!1),a=Object(s.a)(n,2),r=a[0],i=a[1],o=Object(c.useRef)(null),l=Object(c.useRef)(e);l.current=e;var u=function(e){t.current=e,i(e)};return{dragging:r,eventHandler:{onPointerDown:function(e){var n=e.currentTarget,a=Be(e),r=Date.now();if(!t.current){u(!0),o.current=a,l.current.onStart&&l.current.onStart(a);var c=function(e){var t=Be({clientX:e.clientX,clientY:e.clientY,currentTarget:n});l.current.onMove({current:t,last:o.current,delta:t.subtract(o.current)}),o.current=t};document.addEventListener("pointermove",c),document.addEventListener("pointerup",(function e(t){Date.now()-r>300&&(l.current.onEnd&&l.current.onEnd(),u(!1),o.current=null,document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",e))}))}}}}},Ue=function(e){return 1===e.length?e[0]:e[0].add(e[1].subtract(e[0]).scale(.5))},We=function(e){return 1===e.length?null:e[1].subtract(e[0]).length},Ve=function(e,t){var n=Object(X.a)(e.touches).map((function(e){return Fe(w.fromClientCoords(e),t)}));return{distance:We(n),position:Ue(n),touchCount:n.length}},Xe=function(e){var t=Object(c.useRef)({position:w.zero,distance:null,touchCount:0}),n=Object(c.useRef)(e);n.current=e;var a=function(e){var t=Object(c.useRef)(e),n=Object(c.useState)(t.current),a=Object(s.a)(n,2),r=a[0],i=a[1];return[function(){return t.current},function(e){t.current=e,i(e)},r]}(!1),r=Object(s.a)(a,2),i=r[0],o=r[1];return{eventHandlers:{onTouchStart:function(e){if(e.preventDefault(),e.stopPropagation(),!i()){var a=function(e){if(i()){console.log("touches: "+e.touches.length);var a=Ve(e,n.current.svgTargetRef.current),r=function(e,t){return{last:!!e.touchCount!==!!t.touchCount?t:e,current:t,delta:{position:t.position&&e.position&&t.position.subtract(e.position),distance:t.distance&&e.distance&&t.distance-e.distance,touchCount:t.touchCount-e.touchCount}}}(t.current,a);n.current.onMove(r),t.current=a}};o(!0),t.current=Ve(e.nativeEvent,n.current.svgTargetRef.current),document.addEventListener("touchmove",a),document.addEventListener("touchend",(function e(t){i()&&(o(!1),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",e),n.current.onEnd&&n.current.onEnd())})),n.current.onStart&&n.current.onStart()}}}}},He=function(){function e(t,n){Object(f.a)(this,e),this.translate=t,this.scale=n,Object.freeze(this)}return Object(b.a)(e,[{key:"withTranslate",value:function(t){return new e(t,this.scale)}},{key:"withScale",value:function(t){return new e(this.translate,t)}},{key:"translateScaleString",get:function(){return"".concat(this.translateString," ").concat(this.scaleString)}},{key:"scaleTranslateString",get:function(){return"".concat(this.scaleString," ").concat(this.translateString)}},{key:"translateString",get:function(){return"translate(".concat(this.translate.x," ").concat(this.translate.y,")")}},{key:"scaleString",get:function(){return"scale(".concat(this.scale," ").concat(this.scale,")")}},{key:"translateScaleAttribute",get:function(){return{transform:this.translateScaleString}}},{key:"scaleTranslateAttribute",get:function(){return{transform:this.scaleTranslateString}}}]),e}();He.identity=new He(w.zero,1);var Je,Ze,Qe=function(e){var t=e.viewportService,n=e.children,a=Object(c.useRef)(null),r=Object(c.useRef)(null),o=De(t.transform$,He.identity),l=De(t.mouseDragEnabled$,!1),s=De(t.touchEnabled$,!1);Object(c.useEffect)((function(){var e=function(e){e.preventDefault(),e.stopPropagation();var n=Be(e,a.current);t.updateTransform((function(t){if(e.ctrlKey){var a=t.scale-t.scale*e.deltaY*.01;return t.withTranslate(t.translate.subtract(n.scale(a)).add(n.scale(t.scale))).withScale(a)}var r=w.fromDeltaCoords(e);return t.withTranslate(t.translate.subtract(r.scale(.01)))}))};return document.addEventListener("wheel",e,{passive:!1}),function(){document.removeEventListener("wheel",e)}}),[]);var u=Ye({onMove:function(e){t.updateTransform((function(t){return t.withTranslate(t.translate.add(e.delta))}))}}),m=Xe({onMove:function(e){t.updateTransform((function(t){var n=e.current.distance&&e.last.distance?e.current.distance/e.last.distance:1,a=e.current.position.subtract(t.translate).scale(1/t.scale),r=e.current.position.subtract(t.translate).scale(1/(t.scale*n));return t.withScale(t.scale*n).withTranslate(t.translate.add(r.subtract(a).scale(t.scale*n)).add(e.current.position.subtract(e.last.position)))}))},svgTargetRef:r});return i.a.createElement(i.a.Fragment,null,i.a.createElement("g",Object.assign({},l?u.eventHandler:{},s?m.eventHandlers:{},{className:Ae({viewport:l,viewport_dragging:u.dragging}),ref:r}),i.a.createElement("g",o.translateScaleAttribute,i.a.createElement("g",{ref:a},n))))},et=function(e){var t=e.children,n=e.width,a=e.height;return i.a.createElement(i.a.Fragment,null,le(n).map((function(e){return le(a).map((function(n){return t(e,n)}))})))},tt=function(e){var t=e.width,n=e.height;return i.a.createElement(et,{width:t,height:n},(function(e,t){return i.a.createElement("rect",{key:"".concat(e,"/").concat(t),className:"background-grid",x:e,y:t,height:1,width:1})}))},nt=function(e){var t=e.onClick,n=e.width,a=e.height,r=e.highlightedSquares,c=e.onHover,o=r.reduce((function(e,t){return e[t.toCoordinateString()]=!0,e}),{});return i.a.createElement(et,{width:n,height:a},(function(e,n){var a=new V(e,n);return i.a.createElement("rect",{key:a.toCoordinateString(),className:Ae({"selection-grid":!0,highlighted:o[a.toCoordinateString()]}),x:e,y:n,height:1,width:1,onClick:function(){return t&&t(a)},onMouseOver:function(){return c(a)}})}))},at=function(e){var t=e.saveSessionService,n=e.battleMapService,a=e.backgroundDrawingService,r=e.notesDrawingService,c=e.modeService,o=e.viewportService,l=De(n.tokens$,[]),u=De(r.active$,!1),m=De(o.viewBox$,null),d=De(Object(A.a)([n.squareSelectable$,c.mode$.pipe(Object(Z.a)(ye("play","manage-token")))]).pipe(Object(Z.a)((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return n&&a}))),!1),h=De(t.gridMap$,null),f=De(n.highlightedSquares$,[]);return i.a.createElement(i.a.Fragment,null,h&&m&&i.a.createElement("svg",{className:"h-100 w-100",viewBox:m.toViewBoxString(),onPointerMove:function(e){}},i.a.createElement(Qe,{viewportService:o},h instanceof S&&i.a.createElement(Pe,{gridMap:h}),i.a.createElement(tt,{width:h.squares.x,height:h.squares.y}),i.a.createElement(Ke,{name:"background",drawingService:a}),d&&i.a.createElement(nt,{width:h.squares.x,height:h.squares.y,highlightedSquares:f,onClick:function(e){return n.selectSquare(e)},onHover:function(e){return n.hoverOverSquare(e)}}),i.a.createElement(Re,{tokens:l,selectedToken$:n.selectedToken$,onClick:function(e){return n.selectToken(e)}}),u&&i.a.createElement(Ke,{name:"notes",drawingService:r}),i.a.createElement(Ge,{drawingService:r}),i.a.createElement(Ge,{drawingService:a}))))},rt=function(e){var t=e.classes,n=e.onClick,a=e.icon,r=e.text,c=e.iconSize,o=e.tooltip,l=e.iconHeight,s="";"string"===typeof t?s=t:"object"===typeof t&&(s=Ae(t));var u=c||16;return i.a.createElement("div",null,i.a.createElement("a",{href:"#",title:o,onClick:function(e){e.preventDefault(),n&&n()},className:"btn btn-sm mb-md-2 "+s},i.a.createElement("div",{className:"icon-button-content"},a&&i.a.createElement(M.G,{icon:a,width:u,height:l||u}),r&&i.a.createElement("span",null,r))))},ct=(Je={},Object(ke.a)(Je,me.s,8),Object(ke.a)(Je,me.m,12),Object(ke.a)(Je,me.l,16),Je),it=function(e){var t=e.drawingService,n=De(t.drawingColor$,t.drawingColor),a=De(t.drawingWidth$,t.drawingWidth),r=De(t.active$,!1),c=De(t.drawingMode$,"draw"),o=function(e,n){var a;return i.a.createElement(rt,{key:e,icon:n,onClick:function(){return t.switchDrawingMode(e)},classes:(a={},Object(ke.a)(a,"btn-warning",c===e),Object(ke.a)(a,"btn-outline-warning",c!==e),Object(ke.a)(a,"mr-2",!0),a)})};return i.a.createElement(i.a.Fragment,null,r&&i.a.createElement(i.a.Fragment,null,o("draw",M.v),o("erase",M.D),i.a.createElement("div",{className:"mr-4"}),Object.values(me).map((function(e){return function(e){var n;return i.a.createElement(rt,{key:e,icon:M.y,iconSize:ct[e],onClick:function(){return t.switchDrawingWidth(e)},classes:(n={},Object(ke.a)(n,"btn-secondary",a===e),Object(ke.a)(n,"btn-outline-secondary",a!==e),Object(ke.a)(n,"drawing-pane-button",!0),Object(ke.a)(n,"mr-2",!0),n)})}(e)})),i.a.createElement("div",{className:"mr-4"}),Object.values(ue).map((function(e){return function(e){var a;return i.a.createElement(rt,{key:e,icon:M.u,onClick:function(){return t.switchDrawingColor(e)},classes:(a={},Object(ke.a)(a,"drawing-button-".concat(e),n!==e),Object(ke.a)(a,"drawing-button-".concat(e,"-selected"),n===e),Object(ke.a)(a,"mr-2",!0),a)})}(e)}))))},ot=function(e){var t=e.modeService,n=De(t.mode$,"play"),a=function(e,a,r){return i.a.createElement(rt,{icon:e,onClick:function(){return t.switchMode(a)},classes:{"btn-outline-primary":a!==n,"btn-primary":a===n},tooltip:r})};return i.a.createElement("div",{className:""},a(M.m,"play",Y.playPage.controlBar.playButton),a(M.t,"manage-token",Y.playPage.controlBar.addTokensButton),a(M.s,"draw-notes",Y.playPage.controlBar.drawNotesButton),a(M.k,"draw-background",Y.playPage.controlBar.drawBackgroundButton),a(M.A,"zoom",Y.playPage.controlBar.zoomButton))},lt=function(e){var t=e.manageTokenService,n=De(t.active$,!1),a=De(t.tokenType$,null),r=De(t.tokenLabel$,null),c=De(t.mode$,"add-token"),o=function(e,n){return i.a.createElement(rt,{icon:e,onClick:function(){return t.switchMode(n)},classes:{"btn-warning":n===c,"btn-outline-warning":n!==c,"mr-2":!0}})};return i.a.createElement(i.a.Fragment,null,n&&i.a.createElement(i.a.Fragment,null,o(M.x,"add-token"),i.a.createElement("div",null,i.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),t.switchMode("switch-token-type")},className:Ae({btn:!0,"btn-sm":!0,"btn-warning":"switch-token-type"===c,"btn-outline-warning":"switch-token-type"!==c,"mr-2":!0,"mb-2":!0})},a&&r&&i.a.createElement("svg",{viewBox:"-0.1 -0.1 1.15 1.15",width:16,height:16},i.a.createElement(ze,{tokenLabel:r,tokenType:a,tokenSize:1})))),i.a.createElement("div",{className:"mr-2"}),o(M.D,"remove-token")))},st=function(e){var t=e.viewportService,n=De(t.mouseDragEnabled$,!1),a=function(e,t){return i.a.createElement(rt,{icon:e,onClick:t,classes:{"btn-warning":!0,"mr-2":!0}})};return i.a.createElement(i.a.Fragment,null,n&&i.a.createElement(i.a.Fragment,null,a(M.x,(function(){return t.zoomIn()})),a(M.h,(function(){return t.zoomOut()}))))},ut=function(e){var t=e.modeService,n=e.notesDrawingService,a=e.backgroundDrawingService,r=e.manageTokenService,c=e.viewportService,o=De(t.oneOf("draw-background","draw-notes","manage-token","zoom"),!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"control-bar_primary navbar navbar-dark bg-dark"},i.a.createElement(ot,{modeService:t})),o&&i.a.createElement("div",{className:"control-bar_secondary"},i.a.createElement("div",{className:"navbar navbar-dark bg-dark"},i.a.createElement(it,{drawingService:n}),i.a.createElement(it,{drawingService:a}),i.a.createElement(lt,{manageTokenService:r}),i.a.createElement(st,{viewportService:c}))))},mt=function(e){var t=e.items,n=e.columns,a=e.component;return i.a.createElement("div",{className:"row p-2"},t.map((function(e,t){return i.a.createElement("div",{key:t,className:"col-".concat(12/n)},a(e))})))},dt=g()(Ze=function(){function e(t,n,a,r){Object(f.a)(this,e),this.x=t,this.y=n,this.width=a,this.height=r}return Object(b.a)(e,[{key:"toViewBoxString",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.width," ").concat(this.height)}}]),e}())||Ze,ht=function(e){var t=e.tokenType,n=e.tokenLabel,a=e.tokenSize,r=e.onClick,c=e.selected,o=e.svgSize,l=e.maxTokenSize,s=new dt(-.25,-.25,l+.5,l+.5);return i.a.createElement("a",{className:Ae({btn:!0,"btn-outline-secondary":!c,"btn-secondary":c}),onClick:function(e){e.preventDefault(),r()}},i.a.createElement("svg",{viewBox:s.toViewBoxString(),width:o,height:o},i.a.createElement(tt,{width:l,height:l}),i.a.createElement(ze,{tokenLabel:n,tokenType:t,tokenSize:a})))},ft=n(47),bt=n.n(ft),pt=function(e){var t=e.children,n=e.onOk,a=e.okEnabled,r=e.onCancel,o=e.buttonText,l=e.header,s=e.open,u=Object(c.useRef)(null);Object(c.useLayoutEffect)((function(){bt()(u.current).modal("hide").on("hide.bs.modal",(function(){r&&r()}))}),[r]),Object(c.useLayoutEffect)((function(){console.log("effect after open",s),bt()(u.current).modal(s?"show":"hide")}),[s]);return i.a.createElement("div",{ref:u,className:"modal fade",id:"exampleModal",tabIndex:-1},i.a.createElement("div",{className:"modal-dialog modal-lg modal-dialog-centered"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title"},l),i.a.createElement("button",{type:"button",className:"close",onClick:r},i.a.createElement("span",null,"\xd7"))),i.a.createElement("div",{className:"modal-body"},t),i.a.createElement("div",{className:"modal-footer"},n&&i.a.createElement("button",{onClick:function(){bt()(u.current).modal("hide"),n&&n()},disabled:void 0!==a&&!a,type:"button",className:"btn btn-primary"},o)))))},gt=function(e){var t=e.assetService,n=e.manageTokenService,a=De(n.isSwitchTokenType$,!1),r=De(n.tokenType$,n.tokenType),o=De(n.tokenLabel$,n.tokenLabel),l=De(n.tokenSize$,n.tokenSize),s=Object(c.useCallback)((function(){return n.switchMode("add-token")}),[n]);return i.a.createElement(pt,{onCancel:s,buttonText:"place it",header:"Add Token",open:a},!!o&&!!r&&!!l&&i.a.createElement("div",null,i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-4"},i.a.createElement(mt,{items:t.tokenTypes,columns:4,component:function(e){return i.a.createElement(ht,{tokenLabel:o,tokenType:e,tokenSize:1,onClick:function(){return n.setTokenType(e)},selected:e===r,svgSize:35,maxTokenSize:1})}})),i.a.createElement("div",{className:"col-4"},i.a.createElement(mt,{items:t.tokenLabels,columns:4,component:function(e){return i.a.createElement(ht,{tokenLabel:e,tokenType:r,tokenSize:1,onClick:function(){return n.setTokenLabel(e)},selected:o===e,svgSize:35,maxTokenSize:1})}})),i.a.createElement("div",{className:"col-4"},i.a.createElement(mt,{items:le(3),columns:1,component:function(e){var t=e+1;return i.a.createElement(ht,{tokenLabel:o,tokenType:r,tokenSize:t,onClick:function(){return n.setTokenSize(t)},selected:l===t,svgSize:90,maxTokenSize:3})}})))))},vt="https://legal.comsysto.com/comsysto.github.io/de/impressum/",Et="https://legal.comsysto.com/comsysto.github.io/en/datenschutz/",yt=function(e){return Object(u.a)(e),i.a.createElement("div",{className:"main-menu_legal-stuff"},i.a.createElement("small",null,i.a.createElement("a",{href:vt,className:"ml-2 mr-2"},i.a.createElement(M.G,{icon:M.q})," Impressum")),i.a.createElement("small",null,i.a.createElement("a",{href:Et},i.a.createElement(M.G,{icon:M.p})," Data Protection")))},wt=function(e){var t=De(e.modeService.oneOf("play"),!1);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(yt,null),i.a.createElement("div",{className:"App h-100"},i.a.createElement(at,e),i.a.createElement(ut,e)),i.a.createElement("div",{className:"App h-100"},i.a.createElement(gt,e)))},St=function(e){return Object(u.a)(e),i.a.createElement(T,{heading:i.a.createElement("h1",null,"Welcome to Gridheim, Stranger!")},i.a.createElement("h3",null,"No Session found"),i.a.createElement("span",null,"It seems that you don't have a session (yet) or that the session is invalid :("),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("span",null,"Please go ",i.a.createElement(m.b,{to:Tn.sessions},"here")," to create a session so we can play :D"))},Ot=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(Q.a)(this,Object(ee.a)(t).call(this))).battleMapService=e,n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"onActivate",value:function(){this.battleMapService.setTokenSelectable(!1),this.battleMapService.setSquareSelectable(!1),this.battleMapService.selectSquare(null),this.battleMapService.selectToken(null)}}]),t}(he),kt=function(){return window.innerWidth/window.innerHeight},jt=n(157),Nt=function(){function e(t,n){Object(f.a)(this,e),this.modeService=t,this.saveSessionService=n,this.transform$S=new ne.a(new He(w.zero,1)),this.transform$=this.transform$S.asObservable(),this.touchEnabled$=this.modeService.oneOf("play","manage-token","zoom"),this.viewBox$=Object(je.a)(new dt(0,0,e.VIEW_BOX_SIZE,e.VIEW_BOX_SIZE/kt())).pipe(Object(jt.a)(1)),this.initialScale$=Object(A.a)([this.saveSessionService.gridMap$,this.viewBox$]).pipe(Object(Z.a)((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return n?Math.min(a.width/n.squares.x,a.height/n.squares.y):1}))),this.mouseDragEnabled$=this.modeService.oneOf("zoom")}return Object(b.a)(e,[{key:"updateTransform",value:function(e){this.transform=e(this.transform)}},{key:"zoomIn",value:function(){this.updateTransform((function(e){var t=e.scale+.1*e.scale;return e.withScale(t).withTranslate(e.translate.add(e.translate.scale(e.scale)).subtract(e.translate.scale(t)))}))}},{key:"zoomOut",value:function(){this.updateTransform((function(e){var t=e.scale-.1*e.scale;return e.withScale(t).withTranslate(e.translate.add(e.translate.add(w.fromNumber(5)).scale(e.scale)).subtract(e.translate.add(w.fromNumber(5)).scale(t)))}))}},{key:"transform",set:function(e){this.transform$S.next(e)},get:function(){return this.transform$S.value}}]),e}();Nt.VIEW_BOX_SIZE=10;var xt=function(e){var t=e.gridMapService,n=e.sessionRepository,a=Object(c.useState)(null),r=Object(s.a)(a,2),o=r[0],l=r[1],u=Object(c.useState)("LOADING"),m=Object(s.a)(u,2),d=m[0],h=m[1];return Object(c.useEffect)((function(){var e=new Le(t,n),a=new se,r=new fe(a),c=new pe,i=new pe,o=new ve,s=new Se(a,o),u=new Ot(a),m=new Oe("play",{play:r,"draw-background":c,"draw-notes":i,"manage-token":s,zoom:u}),d=new Nt(m,e);return e.add("tokens",a.tokens$).subscribe((function(e){var t=e.flatMap((function(e){var t=o.tokenTypeForName(e.tokenType.name);return t?[new W(e.id,t,e.label,new V(e.square.x,e.square.y),e.size)]:[]}));a.updateTokens((function(){return t}))})),e.add("background-pane",c.pane$.pipe(Object(Z.a)((function(e){return e.withCurrentDrawingRemoved()})))).subscribe((function(e){c.setPane(J.fromJson(e))})),e.add("notes-pane",i.pane$.pipe(Object(Z.a)((function(e){return e.withCurrentDrawingRemoved()})))).subscribe((function(e){i.setPane(J.fromJson(e))})),e.loadAndStart().toPromise().then((function(e){return h(e?"LOADED":"FAILED")})),l({battleMapService:a,playModeService:r,backgroundDrawingService:c,notesDrawingService:i,modeService:m,manageTokenService:s,assetService:o,saveSessionService:e,viewportService:d}),function(){console.log("disposing PlayApp"),e.saveSession(),a.dispose(),r.dispose(),c.dispose(),i.dispose(),u.dispose(),m.dispose(),s.dispose(),o.dispose()}}),[n,t]),i.a.createElement(i.a.Fragment,null,(!o||"LOADING"===d)&&i.a.createElement("div",{className:"App h-100"},i.a.createElement("span",null,"loading ...")),"FAILED"===d&&!!o&&i.a.createElement(St,null),"LOADED"===d&&!!o&&i.a.createElement(wt,o))},Tt=n(104),Mt=n(155),Ct=function(){function e(){var t=this;Object(f.a)(this,e),this.db=new Tt.a("GridHeimBlobStorage"),this.blobs=(t.db.version(1).stores(Object(ke.a)({},e.TABLE_NAME,"key")),t.db.table(e.TABLE_NAME))}return Object(b.a)(e,[{key:"get",value:function(e){return Object(Mt.a)(this.blobs.get(e).then((function(e){return e?e.value:null})))}},{key:"listKeys",value:function(){return Object(Mt.a)(this.blobs.toArray().then((function(e){return Object.freeze(e.map((function(e){return e.key})))})))}},{key:"set",value:function(e,t){return Object(Mt.a)(this.blobs.put({key:e,value:t}).then((function(){})))}},{key:"remove",value:function(e){return Object(Mt.a)(this.blobs.delete(e).then((function(){})))}}]),e}();Ct.TABLE_NAME="blobs";var $t=n(159),Lt=function(e){return e.count().pipe(Object(Z.a)((function(e){return 0===e?null:{to:Tn.sessions,descriptionText:Y.startPage.showSessions.description,actionText:Y.startPage.showSessions.button,section:"play"}})))},Pt=function(e){return e.count().pipe(Object(Z.a)((function(e){return 0===e?null:{to:Tn.gridMaps,descriptionText:Y.startPage.showGridMaps.description,actionText:Y.startPage.showGridMaps.button,section:"gridMaps"}})))},Dt=function(e){var t=e.headline,n=e.icon,a=e.children,r=e.hero;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mb-5"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header".concat(r?" bg-dark text-white":"")},i.a.createElement("h4",null,i.a.createElement(M.G,{icon:n,size:30})," ",t)),i.a.createElement("div",{className:"card-body"},i.a.Children.map(a,(function(e,t){return i.a.createElement(i.a.Fragment,null,0!==t&&i.a.createElement("hr",null),e)})))))))},At=function(e){var t=e.description,n=e.hero,a=e.actionText,r=e.to;return i.a.createElement(i.a.Fragment,null,i.a.createElement("p",{className:"card-text"},t),i.a.createElement(m.b,{className:Ae({btn:!0,"btn-secondary":!n,"btn-primary":!!n,"btn-lg":!!n}),to:r},a))};function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Rt=Y.startPage.sections,qt=function(e){var t,n=e.imageGridMapRepository,a=e.sessionRepository,r=De(Object(A.a)([(t=a,t.findCurrentSession().pipe(Object(Z.a)((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return n&&a?{to:Tn.play,descriptionText:Y.startPage.play.description,actionText:"".concat(Y.startPage.play.button," '").concat(n,"'"),section:"play"}:null})))),Object(je.a)({to:Tn.newSessions,descriptionText:Y.startPage.newSession.description,actionText:Y.startPage.newSession.button,section:"play"}),Lt(a),Object(je.a)({to:Tn.newGridMap,descriptionText:Y.startPage.newGridMap.description,actionText:Y.startPage.newGridMap.button,section:"gridMaps"}),Pt(n),Object(je.a)({to:Tn.about,descriptionText:Y.startPage.about.description,actionText:Y.startPage.about.button,section:"info"}),Object(je.a)({to:Tn.openSource,descriptionText:Y.startPage.openSource.description,actionText:Y.startPage.openSource.button,section:"info"}),Object(je.a)({to:Tn.assets,descriptionText:Y.startPage.assets.description,actionText:Y.startPage.assets.button,section:"info"})]).pipe(Object(Z.a)((function(e){return e.reduce((function(e,t){if(!t)return e;var n=t.section;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(n,!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,Object(ke.a)({},n,[].concat(Object(X.a)(e[n]||[]),[t])))}),{})})),Object($t.a)(1)),{},[a]);return i.a.createElement(T,{heading:i.a.createElement($,{icon:M.r,headline:Y.startPage.headline})},i.a.createElement("div",{className:"container"},Object.entries(r).map((function(e,t){var n=Object(s.a)(e,2),a=n[0],r=n[1];return i.a.createElement(Dt,{key:a,headline:Rt[a].headline,icon:Rt[a].icon,hero:!0},r.map((function(e,n){return i.a.createElement(At,{key:n,description:e.descriptionText,hero:0===n&&0===t,actionText:e.actionText,to:e.to})})))}))))},Ft=function(){function e(t,n,a){Object(f.a)(this,e),this.url=t,this.width=n,this.height=a}return Object(b.a)(e,null,[{key:"of",value:function(t){return Object.freeze(new e(t.url,t.width,t.height))}}]),Object(b.a)(e,[{key:"with",value:function(t){var n=new e(this.url,this.width,this.height);return Object.freeze(Object.assign(n,t))}}]),e}(),Bt=n(156),It=function(){function e(t){Object(f.a)(this,e),this.storageProvider=t,this.isStorageKey=void 0,this.toStorageKey=void 0,this.parseJson=void 0,this.keyToStorageKey=void 0}return Object(b.a)(e,[{key:"findAll",value:function(){var e=this;return this.storageProvider.listKeys().pipe(Object(Te.a)((function(t){var n=t.flatMap((function(t){return t&&e.isStorageKey(t)?[e.loadObject(t)]:[]}));return 0===n.length?Object(je.a)([]):Object(Bt.a)(n).pipe(Object(Z.a)((function(e){return e.flatMap((function(e){return e?[e]:[]}))})),Object(Z.a)((function(e){return Object.freeze(e)})))})))}},{key:"count",value:function(){var e=this;return this.storageProvider.listKeys().pipe(Object(Z.a)((function(t){return t.filter((function(t){return e.isStorageKey(t)})).length})))}},{key:"findBy",value:function(e){return this.loadObject(this.keyToStorageKey(e))}},{key:"store",value:function(e){var t=JSON.stringify(e);return this.storageProvider.set(this.toStorageKey(e),t)}},{key:"loadObject",value:function(e){var t=this;return this.storageProvider.get(e).pipe(Object(Z.a)((function(n){if(null===n)return null;var a=JSON.parse(n);try{return t.parseJson(a)}catch(r){return console.log("Failed loading ".concat(e," from local storage"),{name:e,e:r}),null}})))}},{key:"delete",value:function(e){return e?this.storageProvider.remove(this.keyToStorageKey(e)):Object(je.a)(void 0)}}]),e}(),Gt=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(Q.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).isStorageKey=function(e){return S.isStorageKey(e)},n.parseJson=function(e){return new S(e.name,Ft.of(e.image),new He(w.fromCoords(e.transform.translate),e.transform.scale))},n.toStorageKey=function(e){return S.storageKey(e.name)},n.keyToStorageKey=function(e){return S.storageKey(e)},n}return Object(te.a)(t,e),t}(It),_t=function(){function e(t,n,a,r){Object(f.a)(this,e),this.name=t,this.date=n,this.gridMapName=a,this.content=r}return Object(b.a)(e,null,[{key:"storageKey",value:function(e){return"".concat(this.STORAGE_KEY_PREFIX).concat(e)}},{key:"isStorageKey",value:function(e){return e.startsWith(this.STORAGE_KEY_PREFIX)}},{key:"of",value:function(t){return Object.freeze(new e(t.name,t.date,t.gridMapName,t.content))}}]),Object(b.a)(e,[{key:"with",value:function(t){var n=new e(this.name,this.date,this.gridMapName,this.content);return Object.freeze(Object.assign(n,t))}}]),e}();_t.STORAGE_KEY_PREFIX="session-",_t.CURRENT_SESSION_STORAGE_KEY="current-session";var Kt=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(Q.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).isStorageKey=function(e){return _t.isStorageKey(e)},n.parseJson=function(e){return _t.of({name:e.name,date:e.date,gridMapName:e.gridMapName,content:e.content})},n.toStorageKey=function(e){return _t.storageKey(e.name)},n.keyToStorageKey=function(e){return _t.storageKey(e)},n}return Object(te.a)(t,e),Object(b.a)(t,[{key:"storeCurrentSessionName",value:function(e){return this.storageProvider.set(_t.CURRENT_SESSION_STORAGE_KEY,e)}},{key:"findCurrentSessionName",value:function(){return this.storageProvider.get(_t.CURRENT_SESSION_STORAGE_KEY)}},{key:"findCurrentSession",value:function(){var e=this;return this.findCurrentSessionName().pipe(Object(Te.a)((function(t){return t?e.findBy(t).pipe(Object(Z.a)((function(e){return[t,e]}))):Object(je.a)([null,null])})))}}]),t}(It),Yt=function(e){var t=e.children;return i.a.createElement(i.a.Fragment,null,i.a.Children.map(t,(function(e,t){return i.a.createElement(i.a.Fragment,null,!!t&&i.a.createElement("span",{className:"mr-2"}),e)})))},Ut=function(e){var t=e.onBack,n=e.onNext,a=e.nextDisabled,r=e.lastStep;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"mt-2"},i.a.createElement(Yt,null,t&&i.a.createElement("button",{className:"btn btn-sm btn-warning",onClick:function(){t()},type:"button"},i.a.createElement(M.G,{icon:M.f}),"\xa0 Back"),i.a.createElement("button",{className:"btn btn-sm btn-success",onClick:n,type:"button",disabled:a},!r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M.G,{icon:M.g}),"\xa0 Next"),r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(M.G,{icon:M.e}),"\xa0 Finish")))))},Wt=function(e){var t=e.steps,n=e.active,a=t.indexOf(n);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,t.map((function(e,t){var n=t===a,r=t>a;return i.a.createElement("span",{key:e},i.a.createElement("span",{className:"badge badge-".concat(n?"primary":r?"secondary":"success"," ml-2 mr-2")},n&&i.a.createElement(M.G,{icon:M.B}),e),i.a.createElement(M.G,{icon:M.g}))})),i.a.createElement("span",{className:"badge badge-dark  ml-2 mr-2"},i.a.createElement(M.G,{icon:M.E})," Finished")))};function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Xt=i.a.createContext({onValueChange:function(){},value:function(){},input:function(){}});function Ht(e){var t=e.children,n=e.onDone,a=e.onCancel,r=e.title,o=Object(c.useState)({}),l=Object(s.a)(o,2),u=l[0],m=l[1],d=Object(c.useState)(0),h=Object(s.a)(d,2),f=h[0],b=h[1],p=i.a.Children.map(t,(function(e){return e.props})),g={onValueChange:function(e,t){m(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(n,!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},u,Object(ke.a)({},e,t)))},value:function(e){return u[e]},input:function(e){var t=p.findIndex((function(t){return t.id===e}));return 0===t?void 0:u[p[t-1].id]}},v=!u[p[f].id],E=p.map((function(e){return e.title}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header"},i.a.createElement("a",{href:"#",className:"btn btn-secondary float-right",onClick:function(e){e.preventDefault(),a()}},i.a.createElement(M.G,{icon:M.F})),i.a.createElement("h5",null,r),i.a.createElement(Wt,{steps:E,active:E[f]})),i.a.createElement("div",{className:"card-body"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(Xt.Provider,{value:g},i.a.Children.toArray(t)[f])),i.a.createElement("div",{className:"col-md-12"},i.a.createElement(Ut,{onNext:function(){f>=p.length-1?n(u[p[f].id]):b(f+1)},onBack:0!==f?function(){b(f-1),u[p[f].id]=null}:void 0,nextDisabled:v}))))))}function Jt(e){var t=e.children,n=e.id,a=Object(c.useContext)(Xt),r={input:a.input(n),onValueChange:function(e){return a.onValueChange(n,e)},value:a.value(n)};return console.log("wizard steps",{id:n,childArgs:r}),i.a.createElement(i.a.Fragment,null,t(r))}var Zt=function(e){var t=e.value,n=e.onValueChange,a=Object(c.useState)(null),r=Object(s.a)(a,2),o=r[0],l=r[1];Object(c.useEffect)((function(){l(t)}),[t]);var u=function(e){l(e),n(e)},m=function(e){if(e){var t=new Image;t.onload=function(){u(new Ft(e,t.width,t.height))},t.src=e}else u(null)};return i.a.createElement(i.a.Fragment,null,!o&&i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(C,null,"Select a image from your computer, that should be used as map.",i.a.createElement("br",null),"This file is ",i.a.createElement("em",null,"not")," uploaded in the internet but stored in your browser ..."),i.a.createElement("div",{className:"custom-file"},i.a.createElement("input",{type:"file",className:"custom-file-input",id:"customFile",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=t[0],a=new FileReader;a.onloadend=function(){var e=a.result;m(e)},a.readAsDataURL(n)}}}),i.a.createElement("label",{className:"custom-file-label",htmlFor:"customFile"},"Choose file")))),o&&i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("img",{className:"img-thumbnail gridMap-form_image-preview",src:o.url})),i.a.createElement("div",null,i.a.createElement("button",{className:"btn btn-secondary btn-sm",type:"button",onClick:function(){return u(null)}},"Change"))))},Qt=function(){function e(t,n,a){Object(f.a)(this,e),this.dx=t,this.dy=n,this.scale=a}return Object(b.a)(e,null,[{key:"default",value:function(){return Object.freeze(new e(0,0,1))}},{key:"of",value:function(t){return Object.freeze(new e(t.dx,t.dy,t.scale))}}]),Object(b.a)(e,[{key:"with",value:function(t){var n=new e(this.dx,this.dy,this.scale);return Object.freeze(Object.assign(n,t))}},{key:"asTransformString",value:function(){return"scale(".concat(this.scale," ").concat(this.scale,") translate(").concat(this.dx," ").concat(this.dy,")")}}]),e}(),en=function(){function e(t,n){Object(f.a)(this,e),this.topLeft=t,this.sideLength=n,Object.freeze(this)}return Object(b.a)(e,[{key:"move",value:function(t){return new e(this.topLeft.add(t),this.sideLength)}},{key:"moveTopLeftTo",value:function(t){var n=t.subtract(this.topLeft).maxComponent;return new e(this.topLeft.add(w.fromNumber(n)),this.sideLength-n)}},{key:"moveTopRightTo",value:function(t){var n=t.subtract(this.topLeft.addX(this.sideLength)).inverseX.maxComponent;return new e(this.topLeft.addY(n),this.sideLength-n)}},{key:"moveBottomLeftTo",value:function(t){var n=t.subtract(this.topLeft.addY(this.sideLength)).inverseY.maxComponent;return new e(this.topLeft.addX(n),this.sideLength-n)}},{key:"moveBottomRightTo",value:function(t){var n=t.subtract(this.topLeft.add(w.fromNumber(this.sideLength))).maxComponent;return new e(this.topLeft,this.sideLength+n)}},{key:"withSideLength",value:function(t){return new e(this.topLeft,t)}},{key:"withTopLeft",value:function(t){return new e(t,this.sideLength)}},{key:"normalized",get:function(){return this.sideLength>=0?this:new e(this.topLeft.add(w.fromNumber(this.sideLength)),-this.sideLength)}}]),e}(),tn=function(e){var t=e.rect,n=e.width,a=e.height,r=e.onChange,o=Object(c.useState)(t&&new en(t.topLeft.subtract(w.fromNumber(t.sideLength)),3*t.sideLength)),l=Object(s.a)(o,2),u=l[0],m=l[1],d=function(e){m(e);var t=e&&e.normalized;r(t?new en(t.topLeft.add(w.fromNumber(t.sideLength/3)),t.sideLength/3):null)},h=n/600,f=Ye({onStart:function(e){m(new en(e,0))},onMove:function(e){var t=e.current;if(u){var n=t.subtract(u.topLeft).maxComponent;d(u.withSideLength(n))}},onCancel:function(){d(null)}}),b=function(e){return Ye({onMove:function(t){var n=t.current;u&&d(e(n,u))},onCancel:function(){m(null)}})},p=[[b((function(e,t){return t.moveTopLeftTo(e)})),b((function(e,t){return t.moveBottomLeftTo(e)}))],[b((function(e,t){return t.moveTopRightTo(e)})),b((function(e,t){return t.moveBottomRightTo(e)}))]],g=u&&u.normalized;return i.a.createElement("g",null,i.a.createElement("rect",Object.assign({fillOpacity:.01,x:0,y:0,width:n,height:a},f.eventHandler)),g&&i.a.createElement("g",null,le(3).flatMap((function(e){return le(3).map((function(t){return i.a.createElement("rect",{key:"".concat(e,"/").concat(t),x:g.topLeft.x+e*g.sideLength/3,y:g.topLeft.y+t*g.sideLength/3,width:g.sideLength/3,height:g.sideLength/3,stroke:f.dragging?"#0f86ff":"red",fillOpacity:0,strokeDasharray:"".concat(h," ").concat(h),strokeWidth:h})}))})),!f.dragging&&u&&le(2).flatMap((function(e){return le(2).map((function(t){var n=p[e][t];return i.a.createElement("rect",Object.assign({key:"".concat(e,"/").concat(t),x:u.topLeft.x+e*u.sideLength-3*h,y:u.topLeft.y+t*u.sideLength-3*h,width:6*h,height:6*h,strokeOpacity:0,fill:n.dragging?"#0f86ff":"red"},n.eventHandler))}))}))))},nn=function(e){var t=e.transformation,n=e.onTransformationChange,a=Object(c.useState)(t),r=Object(s.a)(a,2),o=r[0],l=r[1];Object(c.useEffect)((function(){l(t)}),[t]);var u=function(e){l(e),n(e)},m=function(e,t){return i.a.createElement("button",{className:"btn btn-sm btn-secondary ml-2",onClick:t,type:"button"},i.a.createElement(M.G,{icon:e}))};return i.a.createElement(i.a.Fragment,null,m(M.i,(function(){u(o.with({scale:o.scale+.1}))})),m(M.j,(function(){u(o.with({scale:o.scale-.1}))})),m(M.d,(function(){u(o.with({dy:o.dy+100*o.scale}))})),m(M.a,(function(){u(o.with({dy:o.dy-100*o.scale}))})),m(M.b,(function(){u(o.with({dx:o.dx+100*o.scale}))})),m(M.c,(function(){u(o.with({dx:o.dx-100*o.scale}))})))},an={center:"center","left-top":"top left corner","right-bottom":"bottom right corner"},rn=function(e){var t=e.image,n=e.onChange,a=e.viewPosition,r=e.rect,o=Object(c.useState)(Qt.default()),l=Object(s.a)(o,2),u=l[0],m=l[1],d=Object(c.useState)(r),h=Object(s.a)(d,2),f=h[0],b=h[1];Object(c.useEffect)((function(){return b(r)}),[r]),Object(c.useEffect)((function(){var e=600/t.width*2,n=Qt.default().with({scale:e,dx:"left-top"===a?0:-(t.width-600/e),dy:"left-top"===a?0:-(t.height-600/e)});m(n)}),[t,a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(C,null,"For calculating the grid position, draw a rect over the image where 9 squares of the battle grid should be displayed later. Try to select an area in the",i.a.createElement("em",null,an[a])," of the map.",i.a.createElement("br",null)),i.a.createElement("div",{className:"mb-2"},i.a.createElement(nn,{transformation:u,onTransformationChange:m})),i.a.createElement("svg",{style:{width:600,height:600},className:"img-thumbnail"},i.a.createElement("g",{transform:u.asTransformString()},i.a.createElement("image",{width:t.width,height:t.height,xlinkHref:t.url}),i.a.createElement(tn,{rect:f,width:t.width,height:t.width,onChange:function(e){b(e),n(e)}}))))))};function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(n,!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ln=function(e){var t=e.image,n=e.rect1,a=e.rect2,r=e.transformParams,o=e.onChange,l=Object(c.useState)(Qt.default()),u=Object(s.a)(l,2),m=u[0],d=u[1],h=Object(c.useState)(r||function(e,t){var n={x:Math.abs(t.topLeft.x-e.topLeft.x),y:Math.abs(t.topLeft.y-e.topLeft.y)},a=n.x>n.y?"x":"y",r=(e.sideLength+t.sideLength)/2,c=n[a];return{axis:a,squareCount:Math.round(c/r),distance:c}}(n,a)),f=Object(s.a)(h,2),b=f[0],p=f[1],g=function(e,t,n){var a=e.distance/e.squareCount,r=(-t.topLeft.x%a+-n.topLeft.x%a)/2,c=-t.topLeft.y%a,i=-n.topLeft.y%a;return new He(new w(r,(c+i)/2),1/a)}(b,n,a),v=Math.ceil(t.width*g.scale+1),E=Math.ceil(t.height*g.scale+1);return Object(c.useEffect)((function(){o(g,b)}),[b]),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(C,null,"As I promised! Here you can make last adjustments to the grid ..."),i.a.createElement("div",{className:"mb-2"},i.a.createElement(nn,{transformation:m,onTransformationChange:d})),i.a.createElement("svg",{style:{width:600,height:600},viewBox:"0 0 ".concat(v," ").concat(E),className:"img-thumbnail"},i.a.createElement("g",{transform:m.asTransformString()},i.a.createElement("g",g.scaleTranslateAttribute,i.a.createElement("image",{width:t.width,height:t.height,xlinkHref:t.url}),i.a.createElement("rect",{x:n.topLeft.x,y:n.topLeft.y,width:n.sideLength,height:n.sideLength,stroke:"#0f86ff",strokeWidth:.03,fillOpacity:0}),i.a.createElement("rect",{x:a.topLeft.x,y:a.topLeft.y,width:a.sideLength,height:a.sideLength,stroke:"#0f86ff",strokeWidth:.03,fillOpacity:0})),le(v).map((function(e){return le(E).map((function(t){return i.a.createElement("rect",{key:"".concat(e,"/").concat(t),x:e,y:t,width:"1",height:"1",stroke:"darkred",strokeWidth:.02,strokeDasharray:"0.02 0.01",fillOpacity:0})}))})))),i.a.createElement("div",{className:"mt-2"},i.a.createElement("button",{className:"btn btn-sm btn-secondary mr-2",onClick:function(){p(on({},b,{squareCount:b.squareCount+1}))},type:"button"},i.a.createElement(M.G,{icon:M.d}),"Too few Squares"),i.a.createElement("button",{className:"btn btn-sm btn-secondary mr-2",onClick:function(){p(on({},b,{squareCount:b.squareCount-1}))},type:"button"},i.a.createElement(M.G,{icon:M.a}),"Too much Squares")))))},sn=function(e){var t=function(e,t){var n=Object(c.useState)(e),a=Object(s.a)(n,2),r=a[0],i=a[1];return[r,function(e){if("function"===typeof e){i((function(t){return e(t)})),t(null)}else i(e),t(e)}]}(null,e.onChange),n=Object(s.a)(t,2),a=n[0],r=n[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("div",{className:"alert alert-primary"},"Last step provide a good name for the map ... and your done :D"),i.a.createElement("div",{className:"input-group mb-2"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("div",{className:"input-group-text"},i.a.createElement(M.G,{icon:M.C}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Background Name",onChange:function(e){r(e.target.value||null)},value:a||""})))))};function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(n,!0).forEach((function(t){Object(ke.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var dn=function(e){var t=e.imageGridMapRepository,n=i.a.createElement($,{icon:M.k,headline:"Add Map"}),a=F(),r=function(){a.history.push(Tn.start)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(T,{heading:n},i.a.createElement(Ht,{onDone:function(e){t.store(new S(e.name,e.image,e.transform)),r()},onCancel:function(){r()},title:"Add Map"},i.a.createElement(Jt,{id:"imageUpload",title:"Open Image"},(function(e){return i.a.createElement(Zt,e)})),i.a.createElement(Jt,{id:"rect1",title:"Mark 1st Square"},(function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(rn,{image:e.input,rect:e.value&&e.value.rect1,onChange:function(t){return e.onValueChange({image:e.input,rect1:t})},viewPosition:"left-top"}))})),i.a.createElement(Jt,{id:"rect2",title:"Mark 2st Square"},(function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(rn,{image:e.input.image,rect:e.value&&e.value.rect2,onChange:function(t){return e.onValueChange(mn({},e.input,{rect2:t}))},viewPosition:"right-bottom"}))})),i.a.createElement(Jt,{id:"preview",title:"Preview"},(function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(ln,{image:e.input.image,rect1:e.input.rect1,rect2:e.input.rect2,transformParams:e.value&&e.value.transformParams,onChange:function(t,n){return e.onValueChange(mn({},e.input,{transform:t,transformParams:n}))}}))})),i.a.createElement(Jt,{id:"Metadata",title:"Naming"},(function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(sn,{onChange:function(t){return e.onValueChange(mn({},e.input,{name:t}))}}))})))))},hn={selectBackground:"Select Background",metadata:"Add Metadata"},fn=function(e){var t=e.onSave,n=e.onCancel,a=e.gridMaps,r=Object(c.useState)(hn.selectBackground),o=Object(s.a)(r,2),l=o[0],u=o[1],m=Object(c.useState)(),d=Object(s.a)(m,2),h=d[0],f=d[1],b=Object(c.useState)(),p=Object(s.a)(b,2),g=p[0],v=p[1];return i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header"},i.a.createElement("a",{href:"#",className:"btn btn-secondary float-right",onClick:function(e){e.preventDefault(),n()}},i.a.createElement(M.G,{icon:M.F})),i.a.createElement("h5",null,"Start Session")),i.a.createElement("div",{className:"card-body"},i.a.createElement(Wt,{steps:Object.values(hn),active:l}),!h&&i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(C,null,"Select a map where you want to play from the list below ..."),i.a.createElement(N,{gridMaps:a},(function(e){return i.a.createElement("button",{className:"btn btn-success",type:"button",onClick:function(){f(e.name),u(hn.metadata)}},i.a.createElement(M.G,{icon:M.e}),"\xa0 Use this map")})))),h&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(C,null,"Provide a memorable name and some other useful information ... and your done :D"),i.a.createElement("div",{className:"input-group mb-2"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement("div",{className:"input-group-text"},i.a.createElement(M.G,{icon:M.C}))),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Session Name",onChange:function(e){return v(e.target.value)},value:g})))),i.a.createElement("div",{className:"row mt-3"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement("button",{className:"btn btn-success",type:"button",onClick:function(){return g&&void(g&&h&&t(_t.of({name:g,date:(new Date).toLocaleString(),gridMapName:h,content:{}})))}},"Save and Start Session"))))))},bn=function(e){return Object(u.a)(e),i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",null,"No Maps found"),i.a.createElement("span",null,"Oh no! It seems that you want create a sessions but we can't find any map :("),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("span",null,"Please go ",i.a.createElement(m.b,{to:Tn.gridMaps},"here")," to create a map.",i.a.createElement("br",null),"Afterwards come back via the menu in the top left corner (Sessions) to start a session."))},pn=function(e){var t=e.sessionRepository,n=e.gridMapService,a=Object(c.useState)({}),r=Object(s.a)(a,2),o=r[0],l=r[1];Object(c.useEffect)((function(){n.getGridMaps().subscribe({next:function(e){l(z(e,(function(e){return e.name})))}})}),[n,t]);var u=B(Tn.start,Tn.play),m=Object(s.a)(u,2),d=m[0],h=m[1],f=0===Object.keys(o).length;return i.a.createElement(T,{heading:i.a.createElement($,{icon:M.z,headline:Y.newSessionPage.headline})},i.a.createElement(C,null,Y.newSessionPage.explanation),f&&i.a.createElement(bn,null),!f&&i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(fn,{onSave:function(e){t.store(e),t.storeCurrentSessionName(e.name),h()},onCancel:function(){d()},gridMaps:Object.values(o)}))))},gn=Object.freeze({React:{page:"https://reactjs.org",licence:"MIT",licenceUrl:"https://github.com/facebook/react/blob/master/LICENSE"},Bootstrap:{page:"https://getbootstrap.com",licence:"MIT",licenceUrl:"https://github.com/twbs/bootstrap/blob/master/LICENSEs"},"React Router":{page:"https://reacttraining.com/react-router/",licence:"MIT",licenceUrl:"https://github.com/ReactTraining/react-router/blob/master/LICENSE"},RxJS:{page:"https://rxjs-dev.firebaseapp.com/",licence:"Apache 2.0",licenceUrl:"https://github.com/ReactiveX/rxjs/blob/master/LICENSE.txt"},Typescript:{page:"https://www.typescriptlang.org/",licence:"Apache 2.0",licenceUrl:"https://github.com/microsoft/TypeScript/blob/master/LICENSE.txt"},Octicons:{page:"https://octicons.github.com/",licence:"MIT",licenceUrl:"https://github.com/primer/octicons/blob/master/LICENSE"},Formik:{page:"https://jaredpalmer.com/formik/docs/overview",licence:"MIT",licenceUrl:"https://github.com/jaredpalmer/formik/blob/master/LICENSE"},Immer:{page:"https://immerjs.github.io/immer/docs/introduction",licence:"MIT",licenceUrl:"https://github.com/immerjs/immer/blob/master/LICENSE"},"Dexie.js":{page:"https://dexie.org/",licence:"Apache 2.0",licenceUrl:"https://github.com/dfahlander/Dexie.js/blob/master/LICENSE"},JQuery:{page:"https://jquery.com/",licence:"MIT",licenceUrl:"https://github.com/jquery/jquery/blob/master/LICENSE.txt"},"Popper.js":{page:"https://popper.js.org/",licence:"MIT",licenceUrl:"https://github.com/FezVrasta/popper.js/blob/master/LICENSE.md"},"Create React App":{page:"https://create-react-app.dev/",licence:"MIT",licenceUrl:"https://github.com/facebook/create-react-app/blob/master/LICENSE"},"es-shims/Array.prototype.flatMap":{page:"https://github.com/es-shims/Array.prototype.flatMap",licence:"MIT",licenceUrl:"https://github.com/es-shims/Array.prototype.flatMap/blob/master/LICENSE"}}),vn=function(e){return Object(u.a)(e),i.a.createElement(T,{heading:i.a.createElement($,{icon:M.t,headline:Y.openSourcePage.headline})},i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body"},i.a.createElement("blockquote",{className:"blockquote"},i.a.createElement("p",{className:"mb-0"},i.a.createElement("em",null,'"If I have seen further it is by standing on the shoulders of giants."')),i.a.createElement("footer",{className:"blockquote-footer"},i.a.createElement("cite",{title:"Source Title"},i.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Bernard_of_Chartres"},"Bernard of Chartres")))))),i.a.createElement("div",{className:"card mt-3"},i.a.createElement("div",{className:"card-body"},i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("th",null,"Project"),i.a.createElement("th",null,"Website"),i.a.createElement("th",null,"Licence")),i.a.createElement("tbody",null,Object.entries(gn).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return i.a.createElement("tr",{key:n},i.a.createElement("td",null,n),i.a.createElement("td",null,i.a.createElement("a",{href:a.page},a.page)),i.a.createElement("td",null,i.a.createElement("a",{href:a.licenceUrl},a.licence)))})))))))},En=function(){function e(t,n){Object(f.a)(this,e),this.name=t,this.defaultValue=n}return Object(b.a)(e,[{key:"get",value:function(){var e=this.key;switch(localStorage.getItem(e)){case"true":return!0;case"false":return!1;default:return this.defaultValue}}},{key:"set",value:function(e){localStorage.setItem(this.key,"".concat(e))}},{key:"key",get:function(){return"toggle-".concat(this.name)}}]),e}(),yn=Object.freeze({redirectToAbout:new En("redirect-to-about",!0)}),wn=function(e){var t=e.children,n=yn.redirectToAbout.get();return n&&yn.redirectToAbout.set(!1),i.a.createElement(i.a.Fragment,null,n&&i.a.createElement(d.a,{to:Tn.about}),!n&&t)},Sn=function(e){return Object(u.a)(e),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"navbar navbar-dark bg-dark logo-menu"},i.a.createElement(m.b,{className:"btn mb-md-2 btn-outline-primary logo-button",to:Tn.start},i.a.createElement("div",null,i.a.createElement("div",{className:"position-absolute"},i.a.createElement(M.G,{icon:M.n,width:30,height:50}))))))},On=n(105),kn=n.n(On),jn=function(e){var t,n=e.noBackground,a=e.noHomeButton,r=e.hideLegal,c=e.noRedirectToAboutOnFirstVisit,o=e.children;return i.a.createElement(i.a.Fragment,null,(t=i.a.createElement(i.a.Fragment,null,!r&&i.a.createElement(yt,null),!a&&i.a.createElement(Sn,null),!n&&i.a.createElement("img",{src:kn.a,className:"background"}),o),c?i.a.createElement(wn,null,t):t))},Nn=function(e){return Object(u.a)(e),i.a.createElement(T,{heading:i.a.createElement($,{icon:M.k,headline:Y.assetPage.headline})},i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body"},i.a.createElement("table",{className:"table"},i.a.createElement("thead",null,i.a.createElement("th",null,"Image"),i.a.createElement("th",null,"Artist"),i.a.createElement("th",null,"Website")),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Background (Mountain)"),i.a.createElement("td",null,i.a.createElement("a",{href:"https://unsplash.com/@johnwestrock"},"John Westrock")),i.a.createElement("td",null,i.a.createElement("a",{href:"https://unsplash.com/photos/UHFQPFt5-WA"},"Unsplash"))))))))},xn=function(){function e(t){Object(f.a)(this,e),this.imageGridMapRepository=t}return Object(b.a)(e,[{key:"getGridMaps",value:function(){return this.imageGridMapRepository.findAll().pipe(Object(Z.a)((function(t){return Object.freeze([].concat(Object(X.a)(t),[e.BLANK_GRID_MAP]))})))}},{key:"getGridMapByName",value:function(t){return t===e.BLANK_GRID_MAP.name?Object(je.a)(e.BLANK_GRID_MAP):this.imageGridMapRepository.findBy(t)}}]),e}();xn.BLANK_GRID_MAP=Object.freeze({name:"BLANK-MAP",isAsset:!1,squares:new w(100,100)});var Tn={start:"/",play:"/play",sessions:"/sessions",newSessions:"/sessions/new",gridMaps:"/manage-maps",newGridMap:"/manage-maps/new",about:"/about",tokenTypes:"/token-types",openSource:"/open-source",assets:"/assets"};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(144);r.a.shim(),l.a.render(i.a.createElement((function(e){Object(u.a)(e);var t=Object(c.useState)((function(){var e=new Ct,t=new Gt(e);return{storageProvider:e,imageGridMapRepository:t,sessionRepository:new Kt(e),gridMapService:new xn(t)}})),n=Object(s.a)(t,1)[0];return i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,null,i.a.createElement("div",{className:"h-100"},i.a.createElement(d.d,null,i.a.createElement(d.b,{path:Tn.start,exact:!0},i.a.createElement(jn,{noHomeButton:!0},i.a.createElement(qt,n))),i.a.createElement(d.b,{path:Tn.play},i.a.createElement(jn,{noBackground:!0,hideLegal:!0},i.a.createElement(xt,n))),i.a.createElement(d.b,{path:Tn.newSessions},i.a.createElement(jn,null,i.a.createElement(pn,n))),i.a.createElement(d.b,{path:Tn.sessions},i.a.createElement(jn,null,i.a.createElement(I,n))),i.a.createElement(d.b,{path:Tn.newGridMap},i.a.createElement(jn,null,i.a.createElement(dn,n))),i.a.createElement(d.b,{path:Tn.gridMaps},i.a.createElement(jn,null,i.a.createElement(P,n))),i.a.createElement(d.b,{path:Tn.tokenTypes},i.a.createElement(jn,null,i.a.createElement(G,null))),i.a.createElement(d.b,{path:Tn.openSource},i.a.createElement(jn,null,i.a.createElement(vn,null))),i.a.createElement(d.b,{path:Tn.assets},i.a.createElement(jn,null,i.a.createElement(Nn,null))),i.a.createElement(d.b,{path:Tn.about,noRedirectToAboutOnFirstVisit:!0},i.a.createElement(jn,null,i.a.createElement(U,null)))))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[106,1,2]]]);
//# sourceMappingURL=main.cfef868f.chunk.js.map